import{r as D,y as H,R as P}from"./index-4774ace6.js";const b=t=>{let e;const n=new Set,o=(c,f)=>{const S=typeof c=="function"?c(e):c;if(!Object.is(S,e)){const h=e;e=f??typeof S!="object"?S:Object.assign({},e,S),n.forEach(g=>g(e,h))}},s=()=>e,d={setState:o,getState:s,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{n.clear()}};return e=t(o,s,d),d},j=t=>t?b(t):b;var _={exports:{}},O={},A={exports:{}},F={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E=D;function $(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var L=typeof Object.is=="function"?Object.is:$,q=E.useState,z=E.useEffect,U=E.useLayoutEffect,C=E.useDebugValue;function T(t,e){var n=e(),o=q({inst:{value:n,getSnapshot:e}}),s=o[0].inst,r=o[1];return U(function(){s.value=n,s.getSnapshot=e,w(s)&&r({inst:s})},[t,n,e]),z(function(){return w(s)&&r({inst:s}),t(function(){w(s)&&r({inst:s})})},[t]),C(n),n}function w(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!L(t,n)}catch{return!0}}function W(t,e){return e()}var k=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?W:T;F.useSyncExternalStore=E.useSyncExternalStore!==void 0?E.useSyncExternalStore:k;A.exports=F;var B=A.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x=D,J=B;function M(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var N=typeof Object.is=="function"?Object.is:M,V=J.useSyncExternalStore,G=x.useRef,K=x.useEffect,Q=x.useMemo,X=x.useDebugValue;O.useSyncExternalStoreWithSelector=function(t,e,n,o,s){var r=G(null);if(r.current===null){var a={hasValue:!1,value:null};r.current=a}else a=r.current;r=Q(function(){function c(m){if(!f){if(f=!0,S=m,m=o(m),s!==void 0&&a.hasValue){var p=a.value;if(s(p,m))return h=p}return h=m}if(p=h,N(S,m))return p;var l=o(m);return s!==void 0&&s(p,l)?p:(S=m,h=l)}var f=!1,S,h,g=n===void 0?null:n;return[function(){return c(e())},g===null?void 0:function(){return c(g())}]},[e,n,o,s]);var d=V(t,r[0],r[1]);return K(function(){a.hasValue=!0,a.value=d},[d]),X(d),d};_.exports=O;var Y=_.exports;const Z=H(Y),{useDebugValue:ee}=P,{useSyncExternalStoreWithSelector:te}=Z;function re(t,e=t.getState,n){const o=te(t.subscribe,t.getState,t.getServerState||t.getState,e,n);return ee(o),o}const I=t=>{const e=typeof t=="function"?j(t):t,n=(o,s)=>re(e,o,s);return Object.assign(n,e),n},ne=t=>t?I(t):I;function oe(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var r;const a=c=>c===null?null:JSON.parse(c,e==null?void 0:e.reviver),d=(r=n.getItem(s))!=null?r:null;return d instanceof Promise?d.then(a):a(d)},setItem:(s,r)=>n.setItem(s,JSON.stringify(r,e==null?void 0:e.replacer)),removeItem:s=>n.removeItem(s)}}const R=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(o){return R(o)(n)},catch(o){return this}}}catch(n){return{then(o){return this},catch(o){return R(o)(n)}}}},se=(t,e)=>(n,o,s)=>{let r={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:u=>u,version:0,merge:(u,v)=>({...v,...u}),...e},a=!1;const d=new Set,c=new Set;let f;try{f=r.getStorage()}catch{}if(!f)return t((...u)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...u)},o,s);const S=R(r.serialize),h=()=>{const u=r.partialize({...o()});let v;const i=S({state:u,version:r.version}).then(y=>f.setItem(r.name,y)).catch(y=>{v=y});if(v)throw v;return i},g=s.setState;s.setState=(u,v)=>{g(u,v),h()};const m=t((...u)=>{n(...u),h()},o,s);let p;const l=()=>{var u;if(!f)return;a=!1,d.forEach(i=>i(o()));const v=((u=r.onRehydrateStorage)==null?void 0:u.call(r,o()))||void 0;return R(f.getItem.bind(f))(r.name).then(i=>{if(i)return r.deserialize(i)}).then(i=>{if(i)if(typeof i.version=="number"&&i.version!==r.version){if(r.migrate)return r.migrate(i.state,i.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return i.state}).then(i=>{var y;return p=r.merge(i,(y=o())!=null?y:m),n(p,!0),h()}).then(()=>{v==null||v(p,void 0),a=!0,c.forEach(i=>i(p))}).catch(i=>{v==null||v(void 0,i)})};return s.persist={setOptions:u=>{r={...r,...u},u.getStorage&&(f=u.getStorage())},clearStorage:()=>{f==null||f.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>l(),hasHydrated:()=>a,onHydrate:u=>(d.add(u),()=>{d.delete(u)}),onFinishHydration:u=>(c.add(u),()=>{c.delete(u)})},l(),p||m},ie=(t,e)=>(n,o,s)=>{let r={storage:oe(()=>localStorage),partialize:l=>l,version:0,merge:(l,u)=>({...u,...l}),...e},a=!1;const d=new Set,c=new Set;let f=r.storage;if(!f)return t((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...l)},o,s);const S=()=>{const l=r.partialize({...o()});return f.setItem(r.name,{state:l,version:r.version})},h=s.setState;s.setState=(l,u)=>{h(l,u),S()};const g=t((...l)=>{n(...l),S()},o,s);let m;const p=()=>{var l,u;if(!f)return;a=!1,d.forEach(i=>{var y;return i((y=o())!=null?y:g)});const v=((u=r.onRehydrateStorage)==null?void 0:u.call(r,(l=o())!=null?l:g))||void 0;return R(f.getItem.bind(f))(r.name).then(i=>{if(i)if(typeof i.version=="number"&&i.version!==r.version){if(r.migrate)return r.migrate(i.state,i.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return i.state}).then(i=>{var y;return m=r.merge(i,(y=o())!=null?y:g),n(m,!0),S()}).then(()=>{v==null||v(m,void 0),m=o(),a=!0,c.forEach(i=>i(m))}).catch(i=>{v==null||v(void 0,i)})};return s.persist={setOptions:l=>{r={...r,...l},l.storage&&(f=l.storage)},clearStorage:()=>{f==null||f.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>p(),hasHydrated:()=>a,onHydrate:l=>(d.add(l),()=>{d.delete(l)}),onFinishHydration:l=>(c.add(l),()=>{c.delete(l)})},r.skipHydration||p(),m||g},ae=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?se(t,e):ie(t,e),ue=ae;function ce(t){return{routines:t.routines.map(e=>({...e,exercises:e.exercises.map(n=>({...n,executions:[]}))}))}}function le(t){return{routines:t.routines.map(e=>({...e,executions:[],exercises:e.exercises.map(({executions:n,...o})=>o)}))}}function de(t,e){let n=t;return e<1&&(n=ce(t)),e<2&&(n=le(t)),n}const me=ne(ue(t=>({routines:[],addRoutine:e=>{t(n=>({routines:n.routines.concat(e)}))},removeRoutine:e=>{t(n=>({routines:n.routines.filter(o=>o.id!==e)}))},updateRoutine:e=>{t(n=>({routines:n.routines.map(o=>o.id===e.id?e:o)}))},actualRoutineExecutionId:null,setActualRoutineExecutionId:e=>{t(()=>({actualRoutineExecutionId:e}))},addRoutineExecution:(e,n)=>{t(o=>({routines:o.routines.map(s=>s.id!==e?s:{...s,executions:s.executions.concat(n)})}))},addExerciseExecution:(e,n,o)=>{t(s=>({routines:s.routines.map(r=>r.id!==e?r:{...r,executions:r.executions.map(a=>a.id!==n?a:{...a,exercises:a.exercises.concat(o)})})}))},addSetExecution:(e,n,o,s)=>{t(r=>({routines:r.routines.map(a=>a.id!==e?a:{...a,executions:a.executions.map(d=>d.id!==n?d:{...d,exercises:d.exercises.map(c=>c.id!==o?c:{...c,sets:c.sets.concat(s)})})})}))},removeSetExecution:(e,n,o,s)=>{t(r=>({routines:r.routines.map(a=>a.id!==e?a:{...a,executions:a.executions.map(d=>d.id!==n?d:{...d,exercises:d.exercises.map(c=>c.id!==o?c:{...c,sets:c.sets.filter(f=>f.id!==s)})})})}))}}),{name:"gym-storage",version:2,migrate:de}));export{me as u};
