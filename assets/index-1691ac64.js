import{r as l,j as e,k as T,l as A,u as W,S as _,B as v,L as N}from"./index-bff2bf02.js";import{C as $,T as z}from"./card-ebb3b95d.js";import{u as D}from"./store-6133782e.js";import{C as I,a as S}from"./chevron-up-020a5770.js";const P=60,w=48,k=45,L=45,C=l.createContext(null);function y({children:n,value:a,onChange:u}){const[d,x]=l.useState(0),[m,h]=l.useState([]),p=l.useRef(null);l.useEffect(()=>{if(a===void 0)return;const i=m.indexOf(a);i!==-1&&x(-i*w)},[a,m]);const f=(i,j)=>{h(g=>{const t=[...g];return t[i]=j,t})},s=i=>{p.current=d+i.touches[0].clientY},o=i=>{if(p.current===null)return;const j=p.current-i.touches[0].clientY;x(j)},r=()=>{p.current=null;const i=-Math.round(d/w);x(-i*w);const j=m[i];u==null||u(j)};return e.jsx(C.Provider,{value:{delta:d,onTouchStart:s,onTouchMove:o,onTouchEnd:r,registerItem:f},children:n})}const M=()=>{const n=l.useContext(C);if(!n)throw new Error("useWheelInput must be used within a WheelInput");return n};function b({className:n,children:a,...u}){const{onTouchStart:d,onTouchMove:x,onTouchEnd:m}=M();return e.jsx("ul",{...u,className:T("relative h-32 w-full overflow-hidden border first-of-type:rounded-l-xl last-of-type:rounded-r-xl",n),onTouchStart:d,onTouchMove:x,onTouchEnd:m,children:a})}function E({value:n,className:a,children:u,...d}){const{delta:x,registerItem:m}=M(),[h,p]=l.useState(null),f=l.useMemo(()=>{var r;if(h===null)return null;const s=h.parentElement;if(s===null)return null;const o=(r=s==null?void 0:s.parentElement)==null?void 0:r.children;return o===void 0?null:Array.from(o).indexOf(s)},[h]);return l.useEffect(()=>{f!==null&&m(f,n)},[f,n]),l.useEffect(()=>{if(h===null||f===null)return;const s=x/w,o=V(-90,s*L+f*k,90);h.style.setProperty("transform",`rotateX(${o}deg) translate3d(0px, 0px, ${P}px)`)},[h,f,x]),e.jsx("li",{className:"absolute left-0 top-1/2 w-full -translate-y-1/2",style:{height:w},children:e.jsx("div",{className:T("absolute left-0 top-0 flex w-full items-center justify-center transition-transform duration-75 [transform-style:_preserve-3d;]",a),...d,style:{height:w},ref:p,children:u||n})})}function V(n,a,u){return Math.max(n,Math.min(u,a))}function H(){const n=A(),a=W(),u=D(t=>t.routines),[d,x]=l.useState([]),[m,h]=l.useState(0),[p,f]=l.useState(0),s=l.useMemo(()=>{const t=Number(n.exerciseIndex);return isNaN(t)?a(".."):t},[n.exerciseIndex]),o=l.useMemo(()=>{const t=u.find(c=>c.id===n.id);return t||a("..")},[n.id,u]),r=l.useMemo(()=>{if(!s)return a("..");const t=o==null?void 0:o.exercises[s-1];return t?(h(t.weight),f(t.reps),t):a("..")},[s,o]),i=()=>{x(t=>t.concat({weight:m,reps:p}))},j=t=>{x(c=>c.filter((B,R)=>R!==t))},g=l.useMemo(()=>r?r.sets-d.length:null,[r==null?void 0:r.sets,d.length]);return!o||!r?null:e.jsxs(_,{className:"gap-3",children:[e.jsx("h2",{className:"text-4xl font-bold",children:o==null?void 0:o.name}),e.jsx("hr",{}),e.jsxs("div",{className:"flex flex-row flex-wrap items-baseline justify-between gap-2",children:[e.jsx("h3",{className:"text-2xl",children:r==null?void 0:r.name}),e.jsxs("p",{className:"text-foreground/50",children:[r.sets,"x",r.reps," ",r.weight&&`${r.weight}Kg`]})]}),e.jsx("hr",{}),e.jsx("div",{className:"flex h-0 grow flex-col gap-2 overflow-auto px-4",children:d.map((t,c)=>e.jsxs($,{className:"flex flex-row items-center gap-3 py-2 pl-6 pr-2",children:[e.jsxs("span",{children:[c+1," Serie"]}),e.jsx("div",{className:"grow"}),e.jsxs("span",{children:[t.reps,"Reps ",t.weight,"Kg"]}),e.jsx(v,{type:"button",variant:"outline",size:"icon",onClick:()=>j(c),children:e.jsx(z,{})})]},c))}),g!==null&&g>0&&e.jsx("p",{className:"text-center text-foreground/50",children:g===1?"Falta 1 Serie":`Faltan ${g} Series`}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("span",{className:"text-center",children:"Peso"}),e.jsx("span",{className:"text-center",children:"Repeticiones"}),e.jsx(y,{value:m,onChange:h,children:e.jsx(b,{children:Array.from({length:200},(t,c)=>e.jsx(E,{value:c/2},c))})}),e.jsx(y,{value:p,onChange:f,children:e.jsx(b,{children:Array.from({length:99},(t,c)=>e.jsx(E,{value:c+1},c))})})]}),e.jsxs("div",{className:"flex flex-row gap-2 pt-4",children:[s&&s>1?e.jsx(v,{type:"button",variant:"outline",size:"icon",asChild:!0,children:e.jsx(N,{to:`/run/${n.id}/${s-1}`,children:e.jsx(I,{})})}):e.jsx(v,{type:"button",variant:"outline",size:"icon",asChild:!0,disabled:!0,children:e.jsx(I,{})}),s&&s<o.exercises.length?e.jsx(v,{type:"button",variant:"outline",size:"icon",asChild:!0,children:e.jsx(N,{to:`/run/${n.id}/${s+1}`,children:e.jsx(S,{})})}):e.jsx(v,{type:"button",variant:"outline",size:"icon",asChild:!0,disabled:!0,children:e.jsx(S,{})}),e.jsx(v,{type:"button",variant:"default",className:"w-full grow",onClick:i,children:"Agregar Serie"})]})]})}export{H as default};
